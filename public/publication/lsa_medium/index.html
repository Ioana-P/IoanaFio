<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="I explain the intuition behind Latent Semantic Analysis (LSA) and go through a worked example of applying and visualizing it to a canonical NLP dataset." />

  
  <link rel="alternate" hreflang="en-us" href="/publication/lsa_medium/" />

  
  
  
    <meta name="theme-color" content="rgb(251, 191, 183)" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3a1b2f5c1da49b147f3050c4749cae46.css" />

  



  


  


  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="/publication/lsa_medium/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@wowchemy" />
    <meta property="twitter:creator" content="@wowchemy" />
  
  <meta property="og:site_name" content="Academic" />
  <meta property="og:url" content="/publication/lsa_medium/" />
  <meta property="og:title" content="Latent Semantic Analysis: intuition, math, implementation | Academic" />
  <meta property="og:description" content="I explain the intuition behind Latent Semantic Analysis (LSA) and go through a worked example of applying and visualizing it to a canonical NLP dataset." /><meta property="og:image" content="/publication/lsa_medium/featured.jpeg" />
    <meta property="twitter:image" content="/publication/lsa_medium/featured.jpeg" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2020-04-10T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2020-04-10T00:00:00&#43;00:00">
  

  


    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/publication/lsa_medium/"
  },
  "headline": "Latent Semantic Analysis: intuition, math, implementation",
  
  "image": [
    "/publication/lsa_medium/featured.jpeg"
  ],
  
  "datePublished": "2020-04-10T00:00:00Z",
  "dateModified": "2020-04-10T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Ioana Fiona Preoteasa"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Academic",
    "logo": {
      "@type": "ImageObject",
      "url": "/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "I explain the intuition behind Latent Semantic Analysis (LSA) and go through a worked example of applying and visualizing it to a canonical NLP dataset."
}
</script>

  

  

  

  





  <title>Latent Semantic Analysis: intuition, math, implementation | Academic</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="28e22839922e35dbaeca7ea8fd4fddfc" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.d221902fdb3ac4942841d39f708dccc2.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/post/"><span>Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/uploads/DS_cv_resume.pdf"><span>CV</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="/publication/"><span>Writing</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    








<div class="pub">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Latent Semantic Analysis: intuition, math, implementation</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      Ioana Fiona Preoteasa</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    April, 2020
  </span>
  

  

  

  
  
  
  

  
  

</div>

    





  
</div>



  <div class="article-container">

    

    
    

    

    <div class="space-below"></div>

    <div class="article-style"><p>=========================================================</p>
<h2 id="how-do-we-extract-themes-and-topic-from-text-using-unsupervised-learning">How do we extract themes and topic from text using unsupervised learning</h2>
<hr>
<p>TL;DR — Text data suffers heavily from high-dimensionality. Latent Semantic Analysis (LSA) is a popular, dimensionality-reduction techniques that follows the same method as Singular Value Decomposition. LSA ultimately reformulates text data in terms of <em>r</em> <strong>latent</strong>  (i.e. <strong>hidden</strong>) features, where <em>r</em> is less than <em>m</em>, the number of terms in the data. I’ll explain the <strong>conceptual</strong> and <strong>mathematical</strong> intuition  and run a basic <strong>implementation</strong> in <a href="https://scikit-learn.org/stable/index.html" target="_blank" rel="noopener">Scikit-Learn</a> using the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.fetch_20newsgroups.html" target="_blank" rel="noopener">20 newsgroups</a> dataset.</p>
<p>Language is more than the collection of words in front of you. When you read a text your mind conjures up images and notions. When you read many texts, themes begin to emerge, even if they’re never stated explicitly. Our innate ability to understand and process language defies an algorithmic expression (for the moment). LSA is one of the most popular Natural Language Processing (NLP) techniques for trying to determine themes within text mathematically. LSA is an unsupervised learning technique that rests on two pillars:</p>
<ul>
<li>The distributional hypothesis, which states that words with similar meanings appear frequently together. This is best summarised by JR Firth’s quote “You shall know a word by the company it keeps” [1, p106]</li>
<li>Singular Value Decomposition (SVD — Figure 1) a mathematical technique that we’ll be looking at in greater depth.</li>
</ul>
<p>Note that LSA is an <em>unsupervised</em> learning technique — there is no ground truth. The latent concepts might or might not be there! In the dataset we’ll use later we know there are 20 news categories and we can perform classification on them, but that’s only for illustrative purposes. It’ll often be the case that we’ll use LSA on unstructured, unlabelled data.</p>
<p>Like all Machine Learning concepts, LSA can be broken down into 3 parts: the intuition, the maths and the code. Feel free to use the links in Contents to skip to the part most relevant to you. The full code is available in this <a href="https://github.com/Ioana-P/pca_and_clustering_for_edu_purposes/blob/master/newsgroups_LSA.ipynb" target="_blank" rel="noopener">Github repo</a>.</p>
<p>A note on terminology: generally when decomposition of this kind is done on text data, the terms SVD and LSA (or LSI) are used interchangeably. From now on I’ll be using LSA, for simplicity’s sake.</p>
<p><em>This article assumes some understanding of basic NLP preprocessing and of word vectorisation (specifically</em> <a href="https://medium.com/tf-term-frequency-idf-inverse-document-frequency-from-scratch-in-python-6c2b61b78558" target="_blank" rel="noopener"><em>tf-idf vectorisation</em></a><em>).</em></p>
<h3 id="contents">Contents:</h3>
<hr>
<ol>
<li><a href="#0c85">Intuition</a>: explanation with political news topics</li>
<li><a href="#d570">The Math</a>: SVD as a weighted, ordered sum of matrices <strong>or</strong> as a set of 3 linear transformations</li>
<li><a href="#04db">The code implementation</a>: in Python3 with Scikit-Learn and 20Newsgroups data</li>
<li><a href="#a131">References</a></li>
</ol>
<h1 id="1-intuition">1. Intuition</h1>
<p>(<a href="#3ce3">return to Contents</a>)</p>
<p>In simple terms: LSA takes meaningful text documents and recreates them in <em>n</em> different parts where each part expresses a different way of looking at meaning in the text. If you imagine the text data as a an idea, there would be <em>n</em> different ways of <em>looking</em> at that idea, or <em>n</em> different ways of <em>conceptualising</em> the whole text. LSA reduces our table of data to a table of latent (hidden_)_ concepts.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*1Sldip6QA_xwyyw7DI6SWw.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 1: formula and matrix dimensions for SVD</p>
<p>Suppose that we have some table of data, in this case text data, where each row is one document, and each column represents a term (which can be a word or a group of words, like “baker’s dozen” or “Downing Street”). This is the standard way to represent text data (in a <em>document-term matrix</em>, as shown in Figure 2). The numbers in the table reflect how important that word is in the document. If the number is zero then that word simply doesn’t appear in that document.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*LuETpJGCTOaKAc8zyfjs4g.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 2: Document Term matrix, after applying some sort of vectorisation, in our case TF-IDF (but Bag of Words would also do)</p>
<p>Different documents will be about different topics. Let’s say all the documents are <strong>politics</strong> articles and there are 3 topics: <strong>foreign policy (F.P.), elections and reform</strong>.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*uPHKa66FY0XBnpMM2Kx-1w.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 3: Document-Topic matrix (or Document- <strong>Latent</strong>-Concept if you prefer)</p>
<p>Let’s say that there are articles strongly belonging to each category, some that are in two and some that belong to all 3 categories. We could plot a table where each row is a different document (a news article) and each column is a different topic. In the cells we would have a different numbers that indicated how strongly that document belonged to the particular topic (see Figure 3).</p>
<p>Now if we shift our attention conceptually to the <strong>topics</strong> themselves, we should ask ourselves the following question: <em>do we expect certain</em> <strong><em>words</em></strong> <em>to turn up more often in either of these topics?</em></p>
<p>If we’re looking at foreign policy, we might see terms like “Middle East”, “EU”, “embassies”. For elections it might be “ballot”, “candidates”, “party”; and for reform we might see “bill”, “amendment” or “corruption”. So, if we plotted these topics and these terms in a different table, where the rows are the terms, we would see scores plotted for each term according to which topic it most strongly belonged. Naturally there will be terms that feature in all three documents (“prime minister”, “Parliament”, “decision”) and these terms will have scores across all 3 columns that reflect how much they belong to either category — the higher the number, the greater its affiliation to that topic. So, our second table (Figure 4) consists of terms and topics.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*b2T1vn1LLGWbCjat4tolGg.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 4: Term — Topic matrix</p>
<p>Now the last component is a bit trickier to explain as a table. It’s actually a set of numbers, one for each of our topics. What do the numbers represent? They represent how much each of the topics <em>explains</em> our data.</p>
<p>How do they “explain” the data? Well, suppose that actually, “reform” wasn’t really a salient topic across our articles, and the majority of the articles fit in far more comfortably in the “foreign policy” and “elections”. Thus “reform” would get a really low number in this set, lower than the other two. An alternative is that maybe all three numbers are actually quite low and we actually should have had four or more topics — we find out later that a lot of our articles were actually concerned with economics! By sticking to just three topics we’ve been denying ourselves the chance to get a more detailed and precise look at our data. The technical name for this array of numbers is the “singular values”.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*vQY75Vct3QJJoPQlDLisKg.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 5: Singular values — what is the relative importance of our topics within our text?</p>
<p>So that’s the intuition so far. You’ll notice that our two tables have one thing in common (the documents / articles) and all three of them have one thing in common — the topics, or some representation of them.</p>
<p>Now let’s explain how this is a dimensionality reduction technique. It’s easier to see the merits if we specify a number of documents and topics. Suppose we had 100 articles and 10,000 different terms (just think of how many unique words there would be all those articles, from “amendment” to “zealous”!). In our original document-term matrix that’s 100 rows and 10,000 columns. When we start to break our data down into the 3 components, we can actually choose the number of topics — we could choose to have 10,000 different topics, if we genuinely thought that was reasonable. However, we could probably represent the data with far fewer topics, let’s say the 3 we originally talked about. That means that in our document-topic table, we’d slash about <em>99,997 columns</em>, and in our term-topic table, we’d do the same. The columns and rows we’re discarding from our tables are shown as hashed rectangles in Figure 6. M  is the original document-term table; <em>U</em> is the document-topic table, 𝚺 (sigma) is the array of singular values and <em>V-transpose</em> (the superscript T means that the original matrix T has been flipped along its diagonal) is the document-topic table, but flipped on its diagonal (I’ll explain why in the math section).</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*5najHCdleqnOpvZgJHB1kA.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 6 — what’s hashed we discard</p>
<p>As for the set of numbers denoting topic importance, from a set of 10,000 numbers, each number getting smaller and smaller as it corresponds to a less important topic, we cut down to only 3 numbers, for our 3 remaining topics. This is why the Python implementation for LSA is called <em>Truncated</em> SVD by the way: we’re cutting off part of our table, but we’ll get to the code later. It’s also worth noting that we don’t know what the 3 topics are in advance, we merely hypothesised that there would be 3 and, once we’ve gotten our components, we can explore them and see what the terms are.</p>
<p>Of course, we don’t just want to return to the original dataset: we now have 3 lower-dimensional components we can use. In the code and maths parts we’ll go through which one we actually take forward. In brief, once we’ve truncated the tables (matrices), the product we’ll be getting out is the document-topic table (<em>U</em>) <em>times</em> the singular values (𝚺). This can be interpreted as the documents (all our news articles) along with how much they belong to each topic then <strong>weighted</strong> by the relative importance of each topic. You’ll notice that in that case something’s been left out of this final table — the <em>words.</em> Yes, we’ve gone beyond the words, we’re discarding them but keeping <em>the themes</em>, which is a much more compact way to express our text.</p>
<h1 id="2-the-math">2. The Math</h1>
<p>(<a href="#3ce3">return to Contents</a>)</p>
<p>For the maths, I’ll be going through two different interpretations of SVD: first the general geometric decomposition that you can use with a real square matrix M and second the separable-models decomposition which is more pertinent to our example. SVD is also used in model-based recommendation systems. It is very similar to Principal Component Analysis (PCA), but it operates better on sparse data than PCA does (and text data is almost always sparse). Whereas PCA performs decomposition on the <em>correlation</em> matrix of a dataset, SVD/LSA performs decomposition directly on the dataset as it is.</p>
<p>We will be <strong>factorising</strong> this matrix into constituent matrices. When I say factorising this is essentially the same as when we’re taking a number and representing it its factors, which when multiplied together, give us the original number, e.g. A = B * C * D .</p>
<p>This is also why it’s called Singular Value <strong>Decomposition</strong> — we’re <em>decomposing</em> it into its constituent parts.</p>
<h2 id="general-geometric-decomposition">General geometric decomposition</h2>
<p>The extra dimension that wasn’t available to us in our original matrix, the <em>r</em> dimension, is the amount of <em>latent concepts</em>. Generally we’re trying to represent our matrix as other matrices that have one of their axes being this set of components. You will also note that, based on dimensions, the multiplication of the 3 matrices (when V is transposed) will lead us back to the shape of our original matrix, the <em>r</em> dimension effectively disappearing.</p>
<p>What matters in understanding the math is not the algebraic algorithm by which each number in U, V and 𝚺 is determined, but the mathematical properties of these products and how they relate to each other.</p>
<p>First of all, it’s important to consider first what a matrix actually is and what it can be thought of — a transformation of vector space. In the top left corner of Figure 7 we have two perpendicular vectors. If we have only two variables to start with then the feature space (the data that we’re looking at) can be plotted anywhere in this space that is described by these two <strong>basis</strong> vectors. Now moving to the right in our diagram, the matrix M is applied to this vector space and this transforms it into the new, transformed space in our top right corner. In the diagram below the geometric effect of M would be referred to as “shearing” the vector space; the two vectors <em>𝝈1</em> and <em>𝝈2</em> are actually our singular values plotted in this space.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*wGflVq-hpWnmUto3thkR6g.png" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 7: Source: Wikipedia; <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition" target="_blank" rel="noopener">Singular Value Decomposition</a>; <a href="https://commons.wikimedia.org/wiki/File:Singular-Value-Decomposition.svg#filelinks;" target="_blank" rel="noopener">link</a>; Author : Georg-Johann</p>
<p>Now, just like with geometric transformations of points that you may remember from school, we can reconsider this transformation <em>M</em> as three separate transformations:</p>
<ol>
<li>The rotation (or reflection) caused by <em>V*.</em> Note that <em>V* = V-transpose</em> as V is a real unitary matrix, so the complex conjugate of V is the same as its transpose. In vector terms, the transformation by V or <em>V*</em> keeps the length of the basis vectors the same;</li>
<li>𝚺 has the effect of stretching or compressing all coordinate points along the values of its singular values. Imagine our disc in the bottom left corner as we squeeze it vertically down in the direction of <em>𝝈2</em> and stretch it horizontally along the direction of <em>𝝈1</em>. These two singular values now can be pictured as the major and minor semi-axes of an ellipse. You can of course generalise this to <em>n</em>-dimensions.</li>
<li>Lastly, applying <em>U</em> rotates (or reflects) our feature space. We’ve arrived at the same output as a transformation directly from <em>M</em>.</li>
</ol>
<p>I also recommend the excellent <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition" target="_blank" rel="noopener">Wikipedia entry on SVD</a> as it has a particularly good explanation and GIF of the process.</p>
<p>So, in other words, where <em>x</em> is any column vector:</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /publication/lsa_medium/formula_1_huae8fae504900f8ae279e5e034c9661e9_15651_23dd397b521c2f9d1b44f82cff7c0d41.webp 400w,
               /publication/lsa_medium/formula_1_huae8fae504900f8ae279e5e034c9661e9_15651_08393934825db899d7d9e57c5883571c.webp 760w,
               /publication/lsa_medium/formula_1_huae8fae504900f8ae279e5e034c9661e9_15651_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/publication/lsa_medium/formula_1_huae8fae504900f8ae279e5e034c9661e9_15651_23dd397b521c2f9d1b44f82cff7c0d41.webp"
               width="520"
               height="249"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>The transformation by M on x is the same as the three transformations on x by the matrices on the right</p>
<p>One of the properties of the matrices <em>U</em> and <em>V*</em> is that they’re unitary, so we can say that the columns of both of these matrices form two sets of orthonormal basis vectors. In other words, the column vectors you can get from U would form their own coordinate space, such that if there were two columns <em>U1</em> and <em>U2,</em> you could write out all of the coordinates of the space as combinations of <em>U1</em> and <em>U2</em>. The same applies to the columns of <em>V</em>, <em>V1</em> and <em>V2,</em> and this would generalise to <em>n</em>-dimensions (you’d have <em>n</em>-columns).</p>
<h1 id="separable-models-decomposition">Separable models decomposition</h1>
<p>We can arrive at the same understanding of PCA if we imagine that our matrix M can be broken down into a weighted sum of separable matrices, as shown below.</p>
<p>Decomposition of our data M into a weighted sum of separable matrices, <em>Ai</em></p>
<p>The matrices 𝐴𝑖 are said to be separable because they can be decomposed into the outer product of two vectors, weighted by the singular value 𝝈_i_. Calculating the outer product of two vectors with shapes (<em>m,</em>) and (<em>n,</em>) would give us a matrix with a shape (m,n). In other words, every possible product of any two numbers in the two vectors is computed and placed in the new matrix. The singular value not only weights the sum but orders it, since the values are arranged in descending order, so that the first singular value is always the highest one.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*D8WG84Sg8zkOZl6olTK8ng.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 8: our separable matrices. Note the ≅ sign is representing the fact that the decomposed set of 3 products only <strong>approximates</strong> our original matrix, it does not equal it exactly.</p>
<p>In Figure 8 you can see how you could visualise this. Previously we had the tall <em>U</em>, the square <em>Σ</em> and the long 𝑉-<em>transpose</em> matrices. Now you can picture taking the first vertical slice from <em>U</em>, weighting (multiplying) all its values by the first singular value and then, by doing an outer product with the first horizontal slice of 𝑉_-transpose_, creating a new matrix with the dimensions of those slices. Then we add those products together and we get <em>M</em>. Or, if we don’t do the full sum but only complete it partially, we get the truncated version.</p>
<p>So, for our data:</p>
<ul>
<li>where <em>M</em> is our original (<em>m, n</em>) data matrix — m rows, n columns; <em>m documents, n terms</em></li>
<li>U is a (<em>m, r</em>) matrix — <em>m documents and r concepts</em></li>
<li>Σ is a <em>diagonal</em> (<em>r , r</em>) matrix — all values except those in the diagonal are zero. (But what do the non-zero values represent?</li>
<li>V is a (<em>n, r</em>) matrix — <em>n terms, r concepts</em></li>
</ul>
<p>The values in 𝚺 represent how much each latent concept explains the variance in our data. When these are multiplied by the <em>u</em> column vector for that latent concept, it will effectively weigh that vector.</p>
<p>If we were to decompose this to 5 components, this would look something like this:</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /publication/lsa_medium/formula_2_hu3038c161a4454db15d2e72400bed9bc7_14673_087a12892503fbcada5b088d5d27d77e.webp 400w,
               /publication/lsa_medium/formula_2_hu3038c161a4454db15d2e72400bed9bc7_14673_1d2507fdbdd2dad7307882d91dbefed5.webp 760w,
               /publication/lsa_medium/formula_2_hu3038c161a4454db15d2e72400bed9bc7_14673_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/publication/lsa_medium/formula_2_hu3038c161a4454db15d2e72400bed9bc7_14673_087a12892503fbcada5b088d5d27d77e.webp"
               width="535"
               height="196"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>A sum of the outer product of our weighted document-concept vector and our term-concept vector</p>
<p>where there would be originally <em>r</em> number of <em>u</em> vectors; 5 singular values and n number of 𝑣_-transpose_ vectors.</p>
<h1 id="3-the-code-implementation">3. The code implementation</h1>
<p>(<a href="#3ce3">return to Contents</a>)</p>
<p>In this last section we’ll see how we can implement basic LSA using Scikit-Learn.</p>
<h2 id="extract-transform-and-load-our-text-data">Extract, Transform and Load our text data</h2>
<pre tabindex="0"><code>from sklearn.datasets import fetch\_20newsgroups  
X\_train, y\_train = fetch\_20newsgroups(subset=&#39;train&#39;, return\_X\_y=True)  
X\_test, y\_test = fetch\_20newsgroups(subset=&#39;test&#39;, return\_X\_y=True)
</code></pre><h2 id="cleaning-and-preprocessing">Cleaning and Preprocessing</h2>
<p>The cleaning of text data is often a very different beast from cleaning of numerical data. You’ll often find yourself having prepared your vectoriser, you model and you’re ready to Gridsearch and then extract features, only to find that the most important features in cluster <em>x</em> is the string “___” … so you go back…and do more cleaning. The code block below came about as a result of me realizing that I needed to remove website URLs, numbers and emails from the dataset.</p>
<pre tabindex="0"><code>from nltk.corpus import stopwords  
from nltk.tokenize import RegexpTokenizer  
import re  
tokenizer = RegexpTokenizer(r&#39;\\b\\w{3,}\\b&#39;)  
stop\_words = list(set(stopwords.words(&#34;english&#34;)))  
stop\_words += list(string.punctuation)  
stop\_words += \[&#39;\_\_&#39;, &#39;\_\_\_&#39;\]\# Uncomment and run the 3 lines below if you haven&#39;t got these packages already  
\# nltk.download(&#39;stopwords&#39;)  
\# nltk.download(&#39;punkt&#39;)  
\# nltk.download(&#39;wordnet&#39;)def rmv\_emails\_websites(string):  
    &#34;&#34;&#34;Function removes emails, websites and numbers&#34;&#34;&#34; new\_str = re.sub(r&#34;\\S+@\\S+&#34;, &#39;&#39;, string)  
    new\_str = re.sub(r&#34;\\S+.co\\S+&#34;, &#39;&#39;, new\_str)  
    new\_str = re.sub(r&#34;\\S+.ed\\S+&#34;, &#39;&#39;, new\_str)  
    new\_str = re.sub(r&#34;\[0-9\]+&#34;, &#39;&#39;, new\_str)  
    return new\_strX\_train = list(map(rmv\_emails\_websites, X\_train))  
X\_test  = list(map(rmv\_emails\_websites, X\_test))
</code></pre><h2 id="tokenising-and-vectorising-text-data">Tokenising and vectorising text data</h2>
<p>Our models work on numbers, not string! So we tokenise the text (turning all documents into smaller observational entities — in this case words) and then turn them into numbers using Sklearn’s TF-IDF vectoriser. I recommend with any transformation process (especially ones that take time to run) you do them on the first 10 rows of your data and inspect results: are they what you expected to see? Is the shape of the dataframe what you hoped for? Once you’re feeling confident of your code, feed in the whole corpus.</p>
<pre tabindex="0"><code>tfidf = TfidfVectorizer(lowercase=True,   
                        stop\_words=stop\_words,   
                        tokenizer=tokenizer.tokenize,   
                        max\_df=0.2,  
                        min\_df=0.02  
                       )  
tfidf\_train\_sparse = tfidf.fit\_transform(X\_train)  
tfidf\_train\_df = pd.DataFrame(tfidf\_train\_sparse.toarray(),   
                        columns=tfidf.get\_feature\_names())  
tfidf\_train\_df.head()
</code></pre><p>This should give you your vectorised text data — the document-term matrix. Repeat the steps above for the test set as well, but <strong>only</strong> using transform, <strong>not</strong> fit_transform.</p>
<h2 id="lsa-for-exploratory-data-analysis-eda">LSA for Exploratory Data Analysis (EDA)</h2>
<p>Just for the purpose of visualisation and EDA of our decomposed data, let’s fit our LSA object (which in Sklearn is the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html" target="_blank" rel="noopener">TruncatedSVD class</a>) to our train data and specifying only 20 components.</p>
<pre tabindex="0"><code>from sklearn.decomposition import TruncatedSVDlsa\_obj = TruncatedSVD(n\_components=20, n\_iter=100, random\_state=42)tfidf\_lsa\_data = lsa\_obj.fit\_transform(tfidf\_train\_df)  
Sigma = lsa\_obj.singular\_values\_  
V\_T = lsa\_obj.components\_.T
</code></pre><p>Now let’s visualise the singular values — is the barplot below showing us what we expected of them?</p>
<pre tabindex="0"><code>sns.barplot(x=list(range(len(Sigma))), y = Sigma)
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/640/1*U6GCUrfJ1hfOwI7fBkzwNw.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 9 — our singular values, representing how much each latent concept <em>explains the variance in the data</em></p>
<p>Let’s explore our reduced data through the term-topic matrix, <em>V-tranpose.</em> TruncatedSVD will return it to as a numpy array of shape (num_documents, num_components), so we’ll turn it into a Pandas dataframe for ease of manipulation.</p>
<pre tabindex="0"><code>term\_topic\_matrix = pd.DataFrame(data=lsa\_term\_topic,   
                                 index = eda\_train.columns,   
                                 columns = \[f&#39;Latent\_concept\_{r}&#39; for r in range(0,V\_T.shape\[1\])\])
</code></pre><p>Let’s slice our term-topic matrix into Pandas Series (single column data-frames), sort them by value and plot them. The code below plots this for our 2nd latent component (recall that in python we start counting from 0) and returns the plot in Figure 10:</p>
<pre tabindex="0"><code>data = term\_topic\_matrix\[f&#39;Latent\_concept\_1&#39;\]  
data = data.sort\_values(ascending=False)  
top\_10 = data\[:10\]  
plt.title(&#39;Top terms along the axis of Latent concept 1&#39;)  
fig = sns.barplot(x= top\_10.values, y=top\_10.index)
</code></pre><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/640/1*eBXrjYQF7Vao3pLSLGEHiA.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 10: despite the seeming noise at least 3 terms here have a strong theme</p>
<p>These are the words that rank highly along our 2nd latent component. What about the words at the other end of this axis (see Fig 11)?</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/640/1*2E2kZjCp4hUk-mVTrKj_-Q.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 11: it was at this moment the author appreciated how useful lemming/stemming would’ve been</p>
<p>You can make your own mind up about that this semantic divergence signifies. Adding more preprocessing steps would help us cleave through the noise that words like “say” and “said” are creating, but we’ll press on for now. Let’s do one more pair of visualisations for the 6th latent concept (Figures 12 and 13).</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/640/1*sH66WI7jpF5eTiaLhUylgQ.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 12
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/640/1*J8wVB1n2hcrREesFjhxu_Q.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 13: we see once again that technological terms feature strongly in this data</p>
<p>At this point it’s up to us to infer some meaning from these plots. The negative end of concept 5’s axis seems to correlate very strongly with technological and scientific themes (‘space’, ‘science’, ‘computer’), but so does the positive end, albeit more focused on computer related terms (‘hard’, ‘drive’, ‘system’).</p>
<p>Now just to be clear, determining the right amount of components will require tuning, so I didn’t leave the argument set to 20, but changed it to 100. You might think that’s still a large number of dimensions, but our original was 220 (and that was with constraints on our minimum document frequency!), so we’ve reduced a sizeable chunk of the data. I’ll explore in another post how to choose the optimal number of singular values. For now we’ll just go forward with what we have.</p>
<h2 id="using-our-latent-components-in-our-modelling-task">Using our latent components in our modelling task</h2>
<p>Although LSA is an unsupervised technique often used to find patterns in unlabelled data, we’re using it here to reduce the dimensions of labelled data before feeing it into a model. We’ll compare our accuracy on the LSA data with the accuracy on our standard TF-IDF data to gauge how much useful information the LSA has captured from the original dataset. We now have a train dataset of shape (11314, 100). The number of documents is preserved and we have created 100 latent concepts. Now let’s run a model on this and on our standard TF-IDF data. The aim of the implementation below isn’t to get a great model, but to compare the two very different datasets. I’ve included basic cross validation through GridSearchCV and performed a tiny amount of tuning for the tolerance hyperparameter. If you were to do this for the sake of building an actual model, you would go much farther than what’s written below. This is just to help you get a basic implementation going:</p>
<pre tabindex="0"><code>logreg\_lsa = LogisticRegression()  
logreg     = LogisticRegression()  
logreg\_param\_grid = \[{&#39;penalty&#39;:\[&#39;l1&#39;, &#39;l2&#39;\]},  
                 {&#39;tol&#39;:\[0.0001, 0.0005, 0.001\]}\]grid\_lsa\_log = GridSearchCV(estimator=logreg\_lsa,  
                        param\_grid=logreg\_param\_grid,   
                        scoring=&#39;accuracy&#39;, cv=5,  
                        n\_jobs=-1)grid\_log = GridSearchCV(estimator=logreg,  
                        param\_grid=logreg\_param\_grid,   
                        scoring=&#39;accuracy&#39;, cv=5,  
                        n\_jobs=-1)best\_lsa\_logreg = grid\_lsa\_log.fit(tfidf\_lsa\_data, y\_train).best\_estimator\_  
best\_reg\_logreg = grid\_log.fit(tfidf\_train\_df, y\_train).best\_estimator\_print(&#34;Accuracy of Logistic Regression on LSA train data is :&#34;, best\_lsa\_logreg.score(tfidf\_lsa\_data, y\_train))  
print(&#34;Accuracy of Logistic Regression with standard train data is :&#34;, best\_reg\_logreg.score(tfidf\_train\_df, y\_train))
</code></pre><p>Which returns:</p>
<pre tabindex="0"><code>Accuracy of Logistic Regression on LSA train data is : 0.45  
Accuracy of Logistic Regression with standard train data is : 0.52
</code></pre><p>The drop in performance is significant, but you can work this into an optimisation pipeline and tweak the number of latent components. How does this perform on our test data (7532 documents) though?</p>
<pre tabindex="0"><code>Accuracy of Logistic Regression on LSA test data is : 0.35  
Accuracy of Logistic Regression on standard test data is : 0.37
</code></pre><p>Accuracy has dropped greatly for both, but notice how small the gap between the models is! Our LSA model is able to capture about as much information from our test data as our standard model did, with less than half the dimensions! Since this is a multi-label classification it would be best to visualise this with a confusion matrix (Figure 14). Our results look significantly better when you consider the random classification probability given 20 news categories. If you’re not familiar with a confusion matrix, as a rule of thumb, we want to maximise the numbers down the diagonal and minimise them everywhere else.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="https://miro.medium.com/max/720/1*I24_6q3dvnKNuLSw2Sth0Q.jpeg" alt="" loading="lazy" data-zoomable /></div>
  </div></figure>
Figure 14— <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html" target="_blank" rel="noopener">Confusion matrix</a> for our test data (7532 documents). y-axis represents actual news categories, x-axis represents predicted news categories. The diagonal values are all the correctly classified documents.</p>
<p>And that concludes our implementation of LSA in Scikit-Learn. We’ve covered the intuition, mathematics and coding of this technique.</p>
<p>I hope you’ve enjoyed this post and would appreciate any amount of claps. Feel free to leave any feedback (positive or constructive) in the comments, especially about the math section, since I found that the most challenging to articulate.</p>
<h1 id="4-references">4. References</h1>
<p>(<a href="http://3ce3" target="_blank" rel="noopener">return to Contents</a>)</p>
<h2 id="references">References:</h2>
<p>[1] L. Hobson, H. Cole, H. Hapke, <a href="https://www.manning.com/books/natural-language-processing-in-action" target="_blank" rel="noopener">Natural Language Processing in Action</a> (2019), <a href="https://www.manning.com/books/natural-language-processing-in-action" target="_blank" rel="noopener">https://www.manning.com/books/natural-language-processing-in-action</a></p>
<p>[2] Pedregosa <em>et al.,</em> <a href="http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html" target="_blank" rel="noopener">Scikit-learn: Machine Learning in Python</a> (2011), JMLR 12, pp. 2825–2830.</p>
<p>[3] <a href="https://towardsdatascience.com/@yassine.hamdaoui?source=post_page-----6c2b61b78558----------------------" target="_blank" rel="noopener">Hamdaoui</a> Y, <a href="https://medium.com/tf-term-frequency-idf-inverse-document-frequency-from-scratch-in-python-6c2b61b78558" target="_blank" rel="noopener">TF(Term Frequency)-IDF(Inverse Document Frequency) from scratch in python</a> (2019), Towards Data Science</p>
<p>[4] Wikipedia contributers, <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition" target="_blank" rel="noopener">Singular Value Decomposition</a>, <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Singular_value_decomposition</a></p>
</div>

    




<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/nlproc/">NLProc</a>
  
  <a class="badge badge-light" href="/tag/unsupervised-learning/">Unsupervised-Learning</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/publication/lsa_medium/&amp;text=Latent%20Semantic%20Analysis:%20intuition,%20math,%20implementation" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/publication/lsa_medium/&amp;t=Latent%20Semantic%20Analysis:%20intuition,%20math,%20implementation" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Latent%20Semantic%20Analysis:%20intuition,%20math,%20implementation&amp;body=/publication/lsa_medium/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/publication/lsa_medium/&amp;title=Latent%20Semantic%20Analysis:%20intuition,%20math,%20implementation" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Latent%20Semantic%20Analysis:%20intuition,%20math,%20implementation%20/publication/lsa_medium/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/publication/lsa_medium/&amp;title=Latent%20Semantic%20Analysis:%20intuition,%20math,%20implementation" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu7eb9c9766accbf54f7f04ff419d2cc82_1157039_270x270_fill_q75_lanczos_center.jpg" alt="Ioana Fiona Preoteasa">
    

    <div class="media-body">
      <h5 class="card-title">Ioana Fiona Preoteasa</h5>
      
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/Ioana-P" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/ioanapr/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
















  </div>
</div>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  

  
  






  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2022 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.e66e385e2f1df861699d60acd7a9c670.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/python.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":true}</script>

    
    
      <script src="/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js" type="module"></script>
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.ab2f2890dbe3e2e83579366d3d6e8fd9.js"></script>

    
    
    
    
    
    
      
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>






</body>
</html>
